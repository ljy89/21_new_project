<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="RegisterDAO">
	
	<!-- 주문 SEQ번호 생성 SQL  -->
	<select id="selectMaxRseq" resultType="int">
		SELECT NVL2(MAX(rseq), MAX(rseq)+1, 1) FROM register
	</select>

	<!--수강 테이블에 새로운 수강 신청담기 -->
	
	<insert id="insertRegister">
		INSERT INTO register(rseq, sseq, id)
		VALUES(register_seq.NEXTVAL, #{sseq},#{sid})
	</insert>
	
	<!-- 수강신청 취소 -->
	<delete id="deleteSubject" parameterType="int">
		DELETE FROM register
		WHERE rseq=#{rseq}
	
	</delete>
	
	<!-- 학생별 수강 내역 -->
	<select id="listRegisterById" resultType="register">
		SELECT s.name subname, p.name pname,
		 s.time , r.rseq, s.sseq, p.pseq
		 FROM register r, subject s, professor p
		 WHERE id=#{sid}
		  AND r.sseq = s.sseq
		  AND s.id = p.id
	</select>
	
	
	<!-- 이수결과 상태 갱신 -->
	<update id="updateRegisterResult" parameterType="int">
		UPDATE register 
			SET completeyn='y' 
			WHERE rseq=#{rseq}
	</update>

</mapper>